spring.application.name=clothes-shop

# Server Configuration
server.port=${PORT:8080}

# R2DBC PostgreSQL Configuration (supports Railway env vars)
spring.r2dbc.url=r2dbc:postgresql://${DB_HOST:${PGHOST:localhost}}:${DB_PORT:${PGPORT:5432}}/${DB_NAME:${PGDATABASE:ecommerce_db}}?schema=public
spring.r2dbc.username=${DB_USER:${PGUSER:postgres}}
spring.r2dbc.password=${DB_PASSWORD:${PGPASSWORD:1234}}

# Logging
#logging.level.org.springframework.data.r2dbc=DEBUG
#logging.level.io.r2dbc.postgresql.QUERY=DEBUG
logging.level.com.ecommerce.clothesshop=DEBUG

# Paystack Configuration (supports MPESA)
# Get your API key from: https://dashboard.paystack.com/#/settings/developers
# Use Secret Key for backend (starts with sk_test_ for test mode, sk_live_ for production)
paystack.api.key=${PAYSTACK_API_KEY:sk_test_3f4ed3ee01e4b3ea1dcf91b00caecdbadd0c8ade}
paystack.api.url=${PAYSTACK_API_URL:https://api.paystack.co}
# Default callback URL (can be overridden by the payment request)
paystack.callback.url=${PAYSTACK_CALLBACK_URL:http://localhost:8000/payment_callback.php}


# Resilience4j Circuit Breaker
resilience4j.circuitbreaker.instances.paymentService.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.paymentService.slidingWindowSize=10
resilience4j.circuitbreaker.instances.paymentService.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.paymentService.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.paymentService.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.paymentService.waitDurationInOpenState=10s
resilience4j.circuitbreaker.instances.paymentService.failureRateThreshold=50
resilience4j.circuitbreaker.instances.paymentService.eventConsumerBufferSize=10

# Resilience4j Retry
resilience4j.retry.instances.paymentService.maxAttempts=3
resilience4j.retry.instances.paymentService.waitDuration=1s
resilience4j.retry.instances.paymentService.enableExponentialBackoff=true
resilience4j.retry.instances.paymentService.exponentialBackoffMultiplier=2

# Resilience4j TimeLimiter
resilience4j.timelimiter.instances.paymentService.timeoutDuration=5s

# Actuator
management.endpoints.web.exposure.include=health,metrics,circuitbreakers
management.endpoint.health.show-details=always
management.health.circuitbreakers.enabled=true
